# AI Slop Analysis - 2026-02-10

## Executive Summary
- Lines analyzed: 920
- AI-generated code likelihood: **low**
- Total findings: 3
- Action required: **yes**

## Findings by Pattern

### OverDefensive (2)

1. **S1** — `lib/src/arg_utils.dart:21`
   - Severity: `NOTE`
   - Confirmed: `uncertain`
   - Issue: `maybeOne` re-checks `isNotEmpty` after `stringArg`, which already normalizes empty input to `null`.
   - Action: simplify to a null-only check.

2. **S2** — `lib/src/server.dart:236`
   - Severity: `SHOULD_FIX`
   - Confirmed: `uncertain`
   - Issue: `fvm.remove` / `fvm.global` use redundant `version.isEmpty` checks after `stringArg`, and keep an unnecessary `version!`.
   - Action: replace `(version == null || version.isEmpty)` with `version == null`, and remove `!`.

### AvoidRefactor (1)

1. **S3** — `lib/src/server.dart:350-445`
   - Severity: `NOTE`
   - Confirmed: `no`
   - Issue: repeated proxy registration scaffolding exists, but deletion would break MCP tools and current duplication is still manageable.
   - Action: keep as-is; optionally extract helper later if proxy count grows.

## Prioritized Actions

| Priority | Location | Issue | Action |
|----------|----------|-------|--------|
| 1 | `lib/src/server.dart:236` | Redundant post-`stringArg` emptiness checks + unnecessary null assert in mutating handlers | Change to `if (version == null)` and pass `version` directly |
| 2 | `lib/src/arg_utils.dart:21` | Duplicate non-empty validation in `maybeOne` | Remove `v.isNotEmpty` check |
| 3 | `lib/src/server.dart:350-445` | Repeated proxy registration scaffolding | Defer refactor; extract helper only if more proxy tools are added |

## Recommendations
- Standardize on the `stringArg` contract: downstream checks should treat non-null as valid/non-empty.
- Remove duplicated validation in write paths first (`fvm.remove`, `fvm.global`).
- Optionally add a small regression test around `stringArg` + consumers (`maybeOne`, version handlers) to prevent contract drift.
