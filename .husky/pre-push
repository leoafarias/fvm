#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Ensure dart is in PATH
export PATH="$PATH:$HOME/flutter/bin:$HOME/flutter/bin/cache/dart-sdk/bin"

# Try to find dart command
if ! command -v dart >/dev/null 2>&1; then
  echo "Warning: dart command not found in PATH. Skipping pre-push tests."
  echo "PATH: $PATH"
  exit 0
fi

# Run tests before pushing
echo "Running tests..."
dart test

# Optional: Run integration tests if they exist
if [ -f "tool/grind.dart" ]; then
  echo "Running integration tests..."
  dart run grinder integrationTest || echo "Integration tests not available or failed"
fi
