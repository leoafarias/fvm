#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Ensure dart is in PATH
export PATH="$PATH:$HOME/flutter/bin:$HOME/flutter/bin/cache/dart-sdk/bin"

# Try to find dart command
if ! command -v dart >/dev/null 2>&1; then
  echo "Warning: dart command not found in PATH. Skipping pre-push analysis."
  echo "PATH: $PATH"
  exit 0
fi

# Run dart analyze
echo "Running dart analyze..."
dart analyze --fatal-infos || exit 1

# Run DCM analysis if available
if command -v dcm >/dev/null 2>&1; then
  echo "Running DCM analysis..."
  dcm analyze lib || exit 1
else
  echo "DCM not found, skipping DCM analysis"
fi

echo "âœ“ All analysis checks passed"
